# 第一章 操作系统引论
## 1 操作系统基本特征
操作系统的基本特征：
* 并发
* 共享
* 虚拟
* 异步性
### 1.1 并发
并发指两个或多个事件在 **同一时间段** 发生。（区分并行：在同一时间点有两个或多个事件发生）

单处理机情况下，在多道程序处理时，宏观上是并发执行，但是微观上是交替处理执行的。（所以比如4个程序并发，每个执行一分钟，实际需要4分钟。）

因此引入进程（在操作系统中能独立运行的并作为资源分配的基本单位）

### 1.2 共享
共享分为两种：
1. 互斥共享（如打印机、音频设备放音乐等）
2. 同时访问（同时访问同一个文件）

并发和共享是操作系统的两个最基本的特征。二者是相互依存缺一不可。

### 1.3 虚拟
通过某种技术把一个物理实体变为若干个逻辑上的对应物的功能称为虚拟（虚拟机、虚拟内存、虚拟外部设备）

某种技术指：时分复用（处理机利用为用户服务的空闲时间去为另一用户服务）和空分复用（内存利用空闲的空间区域存放和运行其他多道程序）

### 1.4 异步性
指进程的执行顺序和执行时间的不确定性。

## 2 操作系统的主要功能
操作系统的主要功能：
* 处理机管理
* 存储器管理
* 设备管理
* 文件管理
* 用户接口

### 2.1 处理机管理
处理机的分配和运行都是以进程为单位，所以处理机的管理也就是对进程的管理。
* 进程控制

    创建和撤销进程
* 进程同步

    多个进程同时执行时应该有的规矩两种方式
    * 互斥方式
    * 同步方式
* 进程通信
* 进程调度

    包括作业调度和进程调度
    * 作业调度（从外存调入内存）：从后备的作业队列中按照一定的算法选择若干个作业，为他们分配资源，内存空间，将这些作业调入内存后，分别为他们建立进程，是他们都然后将他们插入就绪进程队列中
    * 进程调度（从进程就绪队列选一个分配处理机）：从就绪进程队列根据一定的算法选取一个进程，将处理机分配给他。

### 2.2 存储器管理
为多道程序运行提供环境
* 内存分配

    分配空间、提高利用率、允许动态申请
    * 静态分配

        内存空间时再作业装入后就已经确定，不能再动态增加
    * 动态分配

        允许作业再运行过程中申请附加的内存空间

    
* 内存保护

    * 每道用户程序都只在自己分配的内存空间中运行，互不干扰
    * 绝不允许用户程序访问操作系统的程序和数据
    * 寄存器
* 地址映射

    因为程序中的地址都是从“0”开始，而内存中的地址肯定不是。

    程序中的地址称为 **逻辑地址** 或者 **相对地址**。

    而内存中单元的地址称为 **物理地址**。

    进程装入内存后要由逻辑地址到物理地址进行变换，这就是映射的过程。
* 内存扩充

    不是从物理角度扩大内存的容量。借助虚拟存储技术，从逻辑上扩充，有如下两种方式
    * 请求调入功能

        代码一部分一部分的进入
    * 置换功能

        将内存中暂时用不上的换出来

### 2.3 设备管理功能
设备管理的主要任务：
* 完成用户的I/O请求
* 提高CPU和I/O设备的利用率，提高I/O速度，方便用户使用
因此设备管理应该有如下功能：
* 缓冲管理

    管理CPU和I/O之间的缓冲（因为CPU和I/O速度不匹配，用来提高CPU的利用率）
* 设备分配

    根据用户的I/O请求、系统现有的资源情况分配所需的设备。
* 设备处理

    实现CPU和设备控制器之间的通信。
### 2.4 文件管理功能
对用户文件、系统文件进行管理以方便用户使用，并保证文件的安全性。
* 文件存储空间的管理


* 目录管理

    为每一个文件建立一个目录项
* 文件的读/写管理和保护

    根据用户请求从外存读取数据，或写入数据到外存

    防止系统文件被非法调用
### 2.5 用户接口
* 用户接口
* 程序接口
## 3 操作系统的结构设计
* 软件工程的基本概念
* 传统操作系统结构
* 维内核OS结构
