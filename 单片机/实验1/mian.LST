C51 COMPILER V9.01   MIAN                                                                  05/15/2019 13:47:16 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MIAN
OBJECT MODULE PLACED IN mian.OBJ
COMPILER INVOKED BY: E:\Keil\C51\BIN\C51.EXE mian.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include "reg52.h"                       //此文件中定义了单片机的一些特殊功能寄存器
   2          #include<intrins.h>
   3          typedef unsigned int u16;         //对数据类型进行声明定义
   4          typedef unsigned char u8;
   5          
   6          #define ledd P2
   7          
   8          u16 flag = 1;
   9          
  10          sbit led = P2^0;                 //将单片机的P2.0端口定义为led
  11          sbit k3 = P3^2;                 //定义按键K3
  12          sbit k4 = P3^3;                 //定义按键K4
  13          sbit k2 = P3^1;
  14          sbit led1 = P2^3;
  15          
  16          void delay(u16 i)
  17          {
  18   1              while(i --);    
  19   1      }
  20          
  21          void Int0Init()
  22          {
  23   1              //设置INT0
  24   1              IT0 = 1;//跳变沿出发方式（下降沿）
  25   1              EX0 = 1;//打开INT0的中断允许。  
  26   1              EA = 1;//打开总中断     
  27   1      }
  28          
  29          
  30          void Int1Init()
  31          {
  32   1              //设置INT1
  33   1              IT1 = 1;//跳变沿出发方式（下降沿）
  34   1              EX1 = 1;//打开INT1的中断允许。  
  35   1              EA = 1;//打开总中断     
  36   1      }
  37          
  38          void keypros()
  39          {
  40   1              if(k2==0)                 //检测按键K1是否按下
  41   1              {       
  42   2                      delay(1000);   //消除抖动 一般大约10ms
  43   2                      if(k2==0)        //再次判断按键是否按下
  44   2                      {
  45   3                              led1 =~ led1;   
  46   3                      }
  47   2                      while(!k2);      //检测按键是否松开
  48   2              }               
  49   1      }
  50          
  51          void main()
  52          {
  53   1              Int0Init();  // 设置外部中断0
  54   1              Int1Init();  // 设置外部中断1
  55   1              led = 0;
C51 COMPILER V9.01   MIAN                                                                  05/15/2019 13:47:16 PAGE 2   

  56   1              while(1)
  57   1              {
  58   2                      keypros();
  59   2              }               
  60   1      }
  61          
  62          
  63          void Int0() interrupt 0         //外部中断0的中断函数
  64          {
  65   1              delay(1000);     //延时消抖
  66   1              if(k3 == 0)
  67   1              {
  68   2                      
  69   2                      while(flag)
  70   2                      {
  71   3                              led=0;
  72   3                              delay(50000); //大约延时450ms
  73   3                              led=1;
  74   3                              delay(50000); //大约延时450ms
  75   3                      }
  76   2              }
  77   1      }
  78          
  79          void Int1()     interrupt 2             //外部中断1的中断函数
  80          {
  81   1              delay(1000);     //延时消抖
  82   1              if(k4 == 0)
  83   1              {
  84   2                      u8 i;
  85   2                      ledd=0xfe;
  86   2                      delay(50000); //大约延时450ms   
  87   2                      while(1)
  88   2                      {                       
  89   3                              for(i=0;i<7;i++)         //将led左移一位
  90   3                              {
  91   4                                      ledd=_crol_(ledd,1);
  92   4                                      delay(50000); //大约延时450ms   
  93   4                              }
  94   3                              for(i=0;i<7;i++)        //将led右移一位
  95   3                              {
  96   4                                      ledd=_cror_(ledd,1);
  97   4                                      delay(50000); //大约延时450ms   
  98   4                              }
  99   3                                      
 100   3                      } 
 101   2              }
 102   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    213    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
